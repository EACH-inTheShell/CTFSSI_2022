from Crypto.Util.number import bytes_to_long, long_to_bytes, getStrongPrime
from math import gcd
from random import randint

def rsa(m: int, e: int, n: int) -> int:
    return pow(m, e, n)

if __name__ == '__main__':
    p: int = 25210565022727198985554698187223754304505035845542860634104367535031921337839753766132579048803284200255522082805984881210666112888166729375258112776105068091024832319648184757728433810598247617302016315713769967834821035680924103243531474945473364793848219964231829659888845276459119437232709850917259335965592689301359027329066483438127618157743205197301347815124574076534505433039382215888089437750410555323530646651161311691209249569938917455490431894495713619675917832156884037125363007278750274668623146041078150365114230382237672904496063989035245208058170046067486341045135227819170968455274991150541336520153
    q: int = 27521906533387569670577096685527372185737658704183356677131947423241732246551620806170755570779192533908730768984144088187453515259737081986512969806831751288772986243966683154219111557382383412945200075294613896367970367845076285650700006413590765411877098629366896247118739441809881672101370756644107187132137659030536695123041061519272432771024410469402415554730976181907693664434998715234986114436487385085181925598342999884111630671687137551798201776793782150482919165186495923839766563101904523064321437850417841585965488490634468064942296523982407072496609926343525348773922126228125571641764169285483006335209
    n: int = p * q
    e: int = 1259438572750942160138573070108318740982439258884182682359773
    d: int = pow(e, -1, (p - 1) * (q - 1))

    texto_plano: str = '4pr3nD1_a_d3cr1pToGraf4r_R5A'
    print(f'{texto_plano=}')

    texto_plano_int: int = bytes_to_long(texto_plano.encode('UTF-8'))
    print(f'{texto_plano_int=}')

    texto_criptografado_int: int = rsa(texto_plano_int, e, n)
    print(f'{texto_criptografado_int=}')

    texto_decriptografado: str = long_to_bytes(rsa(texto_criptografado_int, d, n)).decode('UTF-8')

    assert texto_decriptografado == texto_plano

    print(f'{texto_decriptografado=}')
    print(f'Flag: EITS{{{texto_decriptografado}}}')

